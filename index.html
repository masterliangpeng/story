<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="../img/story.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小故事铺</title>

    <!-- SEO优化meta标签 -->
    <meta name="description" content="小故事铺是专业的故事阅读平台，提供睡前故事、儿童故事、历史故事、恐怖故事、爱情故事、励志故事等各类精彩小故事。免费在线阅读，每日更新优质故事内容。">
    <meta name="keywords" content="故事,小故事,故事平台,睡前故事,儿童故事,历史故事,恐怖故事,爱情故事,励志故事,故事大全,在线阅读,免费故事,故事网站,短篇故事,经典故事,温馨故事,感人故事">
    <meta name="author" content="小故事铺">
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="bingbot" content="index,follow">

    <!-- Open Graph标签 -->
    <meta property="og:title" content="小故事铺 - 各类精彩故事在线阅读平台">
    <meta property="og:description" content="汇集睡前故事、儿童故事、历史故事、恐怖故事等各类精彩小故事，免费在线阅读，每日更新">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com">
    <meta property="og:image" content="../img/story.png">
    <meta property="og:site_name" content="小故事铺">
    <meta property="og:locale" content="zh_CN">

    <!-- Twitter Card标签 -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="小故事铺 - 各类精彩故事在线阅读平台">
    <meta name="twitter:description" content="汇集睡前故事、儿童故事、历史故事、恐怖故事等各类精彩小故事">
    <meta name="twitter:image" content="../img/story.png">

    <!-- 其他SEO标签 -->
    <meta name="theme-color" content="#4A90E2">
    <meta name="msapplication-TileColor" content="#4A90E2">
    <meta name="application-name" content="小故事铺">
    <link rel="canonical" href="https://storynook.cn">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <!-- Supabase CDN 引用 -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script> -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
     <script defer src="https://cloud.umami.is/script.js" data-website-id="9ff3dec1-fc8a-41cd-8de1-84e40212d86b"></script>
    <!-- live2d -->
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
    <link rel="stylesheet" href="../live2d/css/live2d.css"/>

    <!-- 移动端检测脚本 -->
    <script>
        // 检测移动端设备并跳转
        function detectMobileAndRedirect() {
            // 检测屏幕宽度
            const screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;

            // 检测用户代理字符串
            const userAgent = navigator.userAgent.toLowerCase();
            const isMobileDevice = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);

            // 如果屏幕宽度小于768px或检测到移动设备，则跳转到appIndex.html
            if (screenWidth <= 768 || isMobileDevice) {
                // 避免无限重定向，检查当前页面是否已经是appIndex.html
                if (!window.location.pathname.includes('appIndex.html')) {
                    window.location.href = 'appIndex.html';
                }
            }
        }

        // 页面加载时检测
        detectMobileAndRedirect();

        // 监听窗口大小变化
        window.addEventListener('resize', detectMobileAndRedirect);
    </script>
</head>
<body>
    <!-- SEO隐藏内容区域 - 供搜索引擎抓取 -->
    <div style="position: absolute; left: -9999px; top: -9999px; width: 1px; height: 1px; overflow: hidden;" aria-hidden="true">
        <h1>小故事铺 - 最全的故事阅读平台</h1>
        <p>小故事铺汇集了各种类型的精彩故事，包括睡前故事、儿童故事、历史故事、恐怖故事、爱情故事、励志故事、神话故事、寓言故事、童话故事、民间故事、科幻故事、悬疑故事、温馨故事、感人故事等。我们致力于为读者提供优质的故事内容，让每个人都能在这里找到属于自己的故事。</p>
        <p>无论您是想要为孩子寻找有趣的儿童故事，还是想在睡前听一些温馨的睡前故事，或者对历史故事、恐怖故事感兴趣，小故事铺都能满足您的需求。我们的故事平台每日更新，为您带来最新最好的故事内容。</p>
        <p>故事分类包括：睡前故事大全、儿童故事集、历史故事精选、恐怖故事合集、爱情故事专区、励志故事频道、经典故事回顾、短篇故事精华、长篇故事连载、原创故事投稿等。</p>
        <p>小故事铺是您身边的故事专家，为您提供免费的在线故事阅读服务。无论何时何地，只要您想听故事、读故事，小故事铺都在这里等您。</p>
        <ul>
            <li>睡前故事 - 温馨治愈的睡前小故事</li>
            <li>儿童故事 - 适合孩子的有趣故事</li>
            <li>历史故事 - 了解历史的精彩故事</li>
            <li>恐怖故事 - 惊险刺激的恐怖小说</li>
            <li>爱情故事 - 浪漫感人的爱情小说</li>
            <li>励志故事 - 激励人心的正能量故事</li>
            <li>神话故事 - 古代神话传说故事</li>
            <li>寓言故事 - 富含哲理的寓言故事</li>
            <li>童话故事 - 经典童话故事大全</li>
            <li>民间故事 - 传统民间故事集</li>
        </ul>
    </div>

    <!-- 侧边栏切换按钮（在收缩状态下可见） -->
    <div class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-chevron-right"></i>
    </div>

    <!-- 左侧侧边栏 -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-inner">
            <!-- 侧边栏顶部 -->
            <div class="sidebar-header">
                <div class="logo">
                    <img src="../img/story.png" alt="小故事铺" class="logo-img">
                    <span>小故事铺</span>
                </div>
                <button class="sidebar-close" id="sidebarClose">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <!-- 功能按钮区 -->
            <div class="sidebar-actions">
                <!-- 多功能按钮 -->
                <div class="multi-function-button" id="multiFunctionButton">
                    <button class="action-button">
                        <i class="fas fa-cog"></i>
                        <span>基础功能</span>
                        <i class="fas fa-chevron-down function-dropdown-icon"></i>
                    </button>
                    <!-- 功能下拉菜单 -->
                    <div class="function-dropdown" id="functionDropdown">
<!--                        <div class="function-item" id="searchButton">-->
<!--                            <i class="fas fa-search"></i>-->
<!--                            <span>故事搜索</span>-->
<!--                        </div>-->
                        <div class="function-item" id="viewModeToggle">
                            <i class="fas fa-list"></i>
                            <span>切换视图</span>
                        </div>
<!--                        <div class="function-item" id="categorySettingsButton">-->
<!--                            <i class="fas fa-sliders-h"></i>-->
<!--                            <span>分类设置</span>-->
<!--                        </div>-->
                        <div class="function-item" id="themeToggle">
                            <i class="fas fa-moon"></i>
                            <span>切换主题</span>
                        </div>
                        <div class="function-item" id="refreshButton">
                            <i class="fas fa-sync-alt"></i>
                            <span>重置刷新</span>
                        </div>
                    </div>
                </div>

                <button class="action-button" id="categorySettingsButton">
                    <i class="fas fa-sliders-h"></i>
                    <span>分类设置</span>
                </button>


                <button class="action-button" id="searchButton">
                    <i class="fas fa-search"></i>
                    <span>故事搜索</span>
                </button>

                <!-- 即时热榜按钮 -->
<!--                <a href="https://nowhots.com/" target="_blank" rel="noopener noreferrer" class="hot-news-button">-->
<!--                    <button class="action-button">-->
<!--                        <img src="../img/host.png" alt="即时热榜" class="hot-news-icon">-->
<!--                        <span>即时热榜</span>-->
<!--                    </button>-->
<!--                </a>-->
            </div>

            <!-- 分类区域 -->
            <div class="sidebar-categories">
                <!-- <h3 class="sidebar-title">分类</h3> -->
                <div class="sidebar-category-list" id="categoryTags">
                    <!-- 分类标签将通过API动态加载 -->
                </div>
            </div>
        </div>
    </aside>

    <!-- 主内容区域 -->
    <main class="main-container" id="mainContainer">
    <!-- 悬浮搜索框 -->
    <div class="floating-search" id="floatingSearch">
<!--        <p style="position:fixed;bottom:10%;right:46%;color:#8f8f8f">支持搜索当前分类下的所有故事</p>-->
        <button class="search-close" id="searchClose">
            <i class="fas fa-times"></i>
        </button>
        <div class="floating-search-container">
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" placeholder="支持搜索当前分类下的所有故事，按回车键搜索...">
            </div>
        </div>

        <div id="landlord">
            <div class="message" style="opacity:0"></div>
            <canvas id="live2d" width="560" height="500" class="live2d"></canvas>
            <div class="hide-button">隐藏</div>
        </div>
    </div>

    <!-- 分类设置弹窗 -->
    <div class="category-settings-modal" id="categorySettingsModal">
        <div class="category-settings-container">
            <div class="settings-header">
                <h3>分类设置</h3>
                <button class="settings-close" id="settingsClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-description">
                选择您想在导航栏显示的分类（最多10个）
            </div>
            <div class="category-list" id="categorySettingsList">
                <!-- 分类选择项将通过JS动态加载 -->
            </div>
        </div>
    </div>

    <div class="container">
        <!-- 首页视图 -->
        <div class="home-view">
            <div class="layout">
                <!-- 主内容区域 -->
                <div class="main-content">
                    <!-- 内容卡片区域 -->
                    <div class="content-grid" id="storyGrid">
                        <!-- 故事卡片将通过API动态加载 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 阅读页面视图 -->
        <div class="article-view">
            <div class="article-header">
                <button class="back-btn" onclick="showHome(false)">
                    <i class="fas fa-arrow-left"></i>
                    <span>返回</span>
                </button>

                <h1 class="article-title" id="storyTitle"></h1>

                <div class="article-meta">
                    <div class="article-account">
                        <!-- <div class="article-account-avatar">
                            <i class="fas fa-book-reader"></i>
                        </div> -->
                        <div class="article-account-info">
                            <div class="article-account-name" id="storyType"></div>
                            <div class="article-date" id="storyReadTime"></div>
                        </div>
                    </div>

                    <!-- 语音朗读控制按钮 -->
                    <div class="tts-controls">
                        <button class="tts-button" id="ttsPlayButton" title="开始朗读">
                            <img src="../img/play.png" alt="开始朗读" class="play-icon">
                        </button>

                        <button class="tts-button" id="ttsReplayButton" title="重播">
                            <img src="../img/replay.png" alt="重播" class="replay-icons">
                        </button>
                    </div>

                    <!-- <div class="article-stats">
                        <span><i class="far fa-file-alt"></i> <span id="storyLength"></span> 字</span>
                    </div> -->
                </div>
            </div>

            <div class="article-content" id="storyContent">
                <!-- 故事内容将通过API动态加载 -->
            </div>
        </div>

        <!-- 全局加载遮罩 -->
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-content">
                <div class="bouncing-loader">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    </main>

    <a href="https://support.qq.com/product/774893" target="_blank" rel="noopener noreferrer" class="feedback-fab" id="feedbackFab" title="意见反馈" aria-label="意见反馈">
        <img src="../img/opinion.png" alt="意见反馈">
    </a>

    <script src="../js/supabase-client.js"></script>
    <script src="../js/app.js"></script>

    <!-- 结构化数据标记 -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "小故事铺",
        "alternateName": "故事阅读平台",
        "url": "https://storynook.cn",
        "description": "小故事铺是专业的故事阅读平台，提供睡前故事、儿童故事、历史故事、恐怖故事、爱情故事、励志故事等各类精彩小故事",
        "keywords": "小故事,故事平台,睡前故事,儿童故事,历史故事,恐怖故事,爱情故事,励志故事",
        "inLanguage": "zh-CN",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://storynook.cn/#search={search_term_string}",
            "query-input": "required name=search_term_string"
        },
        "publisher": {
            "@type": "Organization",
            "name": "小故事铺",
            "logo": {
                "@type": "ImageObject",
                "url": "https://storynook.cn/img/story.png"
            }
        },
        "mainEntity": {
            "@type": "ItemList",
            "name": "故事分类",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "睡前故事",
                    "description": "温馨治愈的睡前小故事，帮助您安然入睡"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "儿童故事",
                    "description": "适合孩子阅读的有趣故事，寓教于乐"
                },
                {
                    "@type": "ListItem",
                    "position": 3,
                    "name": "历史故事",
                    "description": "了解历史的精彩故事，增长知识"
                },
                {
                    "@type": "ListItem",
                    "position": 4,
                    "name": "恐怖故事",
                    "description": "惊险刺激的恐怖小说，挑战胆量"
                },
                {
                    "@type": "ListItem",
                    "position": 5,
                    "name": "爱情故事",
                    "description": "浪漫感人的爱情小说，触动心灵"
                },
                {
                    "@type": "ListItem",
                    "position": 6,
                    "name": "励志故事",
                    "description": "激励人心的正能量故事，传递力量"
                },
                {
                    "@type": "ListItem",
                    "position": 7,
                    "name": "规则怪谈",
                    "description": "规则怪谈，鬼怪传说"
                }
            ]
        }
    }
    </script>

    <script type="text/javascript" src="../live2d/js/live2d.js"></script>
    <script type="text/javascript" src="../live2d/js/message.js"></script>
    <script type="text/javascript">
        loadlive2d("live2d", "../live2d/model/xiaoban/model.json");
    </script>
</body>
</html>
